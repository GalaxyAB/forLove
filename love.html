<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>ğŸ’— pei yi jing ğŸ’—</title>

    <style>
        body{
            margin:0;
            overflow:hidden;
            background:#000;
        }
        canvas{
            position:absolute;
            width:100%;
            height:100%;
        }

        /* â€”â€” ä¸­å¿ƒå¤§å¿ƒå½¢ â€”â€” */
        #pinkboard{
            z-index: 5;           /* ä¸€å®šè¦åœ¨æœ€ä¸Šå±‚æ˜¾ç¤ºï¼ */
            animation: heartbeat 2s ease-in-out infinite;
        }

        @keyframes heartbeat{
            0%{ transform:scale(0.85); }
            50%{ transform:scale(1); }
            100%{ transform:scale(0.85); }
        }

        /* é£˜å¿ƒå±‚ */
        #heartCanvas{
            z-index: 10;  /* é£˜å¿ƒåœ¨æœ€ä¸Šå±‚ */
            pointer-events:none;
        }

        #name{
            position:absolute;
            top:50%;
            left:50%;
            transform:translate(-50%,-50%);
            z-index:20;
            font-size:46px;
            color:#ea80b0;
        }
    </style>
</head>

<body>

<!-- â¤ï¸ ä¸­å¿ƒå¤§å¿ƒå½¢ -->
<canvas id="pinkboard"></canvas>

<!-- ç‚¹å‡»åæ¼«å¤©é£˜å¿ƒ -->
<canvas id="heartCanvas"></canvas>

<div id="name">å†ç‚¹ç‚¹</div>

<audio id="bgm" src="music.mp3" preload="auto" loop></audio>

<!-- â¤ï¸â¤ï¸â¤ï¸ ç¬¬1éƒ¨åˆ†ï¼šä¸­å¿ƒå¤§å¿ƒå½¢åŸç‰ˆä»£ç ï¼ˆä½ æœ€é‡è¦çš„é‚£ä¸€æ®µï¼‰ â¤ï¸â¤ï¸â¤ï¸ -->
<script>
    var settings={particles:{length:500,duration:2,velocity:100,effect:-0.75,size:30}};
    (function(){
        var b=0,c=["ms","moz","webkit","o"];
        for(var a=0;a<c.length&&!window.requestAnimationFrame;++a){
            window.requestAnimationFrame=window[c[a]+"RequestAnimationFrame"];
            window.cancelAnimationFrame=window[c[a]+"CancelAnimationFrame"]||window[c[a]+"CancelRequestAnimationFrame"];}
        if(!window.requestAnimationFrame){
            window.requestAnimationFrame=function(h,e){var d=new Date().getTime();var f=Math.max(0,16-(d-b));
                var g=window.setTimeout(function(){h(d+f)},f);b=d+f;return g;}}
        if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(d){clearTimeout(d)}}})();

    var Point=function(x,y){this.x=x||0;this.y=y||0};
    Point.prototype.clone=function(){return new Point(this.x,this.y)};
    Point.prototype.length=function(len){if(len===undefined)return Math.sqrt(this.x*this.x+this.y*this.y);
        this.normalize();this.x*=len;this.y*=len;return this};
    Point.prototype.normalize=function(){var l=this.length();this.x/=l;this.y/=l;return this};

    var Particle=function(){this.position=new Point();this.velocity=new Point();this.acceleration=new Point();this.age=0};
    Particle.prototype.initialize=function(x,y,dx,dy){
        this.position.x=x;this.position.y=y;this.velocity.x=dx;this.velocity.y=dy;
        this.acceleration.x=dx*settings.particles.effect;this.acceleration.y=dy*settings.particles.effect;this.age=0};
    Particle.prototype.update=function(t){this.position.x+=this.velocity.x*t;this.position.y+=this.velocity.y*t;
        this.velocity.x+=this.acceleration.x*t;this.velocity.y+=this.acceleration.y*t;this.age+=t};
    Particle.prototype.draw=function(c,img){function ease(t){return --t*t*t+1}
        var s=img.width*ease(this.age/settings.particles.duration);
        c.globalAlpha=1-this.age/settings.particles.duration;
        c.drawImage(img,this.position.x-s/2,this.position.y-s/2,s,s)};

    var ParticlePool=function(len){var particles=new Array(len),firstActive=0,firstFree=0,dur=settings.particles.duration;
        for(var i=0;i<len;i++)particles[i]=new Particle();
        this.add=function(x,y,dx,dy){particles[firstFree].initialize(x,y,dx,dy);
            firstFree=(firstFree+1)%len;if(firstActive===firstFree)firstActive=(firstActive+1)%len};
        this.update=function(dt){
            var i;if(firstActive<firstFree){for(i=firstActive;i<firstFree;i++)particles[i].update(dt);}
            if(firstFree<firstActive){for(i=firstActive;i<len;i++)particles[i].update(dt);
                for(i=0;i<firstFree;i++)particles[i].update(dt);}
            while(particles[firstActive].age>=dur && firstActive!==firstFree){
                firstActive=(firstActive+1)%len}};
        this.draw=function(c,img){
            var i;if(firstActive<firstFree){for(i=firstActive;i<firstFree;i++)particles[i].draw(c,img);}
            if(firstFree<firstActive){for(i=firstActive;i<len;i++)particles[i].draw(c,img);
                for(i=0;i<firstFree;i++)particles[i].draw(c,img);}}};

    (function(canvas){
        var context=canvas.getContext("2d"),
            particles=new ParticlePool(settings.particles.length),
            particleRate=settings.particles.length/settings.particles.duration,time;

        function pointOnHeart(t){
            return new Point(160*Math.pow(Math.sin(t),3),
                130*Math.cos(t)-50*Math.cos(2*t)-20*Math.cos(3*t)-10*Math.cos(4*t)+25);}

        var image=(function(){
            var c=document.createElement("canvas"),ctx=c.getContext("2d");
            c.width=settings.particles.size;c.height=settings.particles.size;
            function to(t){var p=pointOnHeart(t);
                p.x=settings.particles.size/2+(p.x*settings.particles.size)/350;
                p.y=settings.particles.size/2-(p.y*settings.particles.size)/350;return p}
            ctx.beginPath();var t=-Math.PI,p=to(t);ctx.moveTo(p.x,p.y);
            while(t<Math.PI){t+=0.01;p=to(t);ctx.lineTo(p.x,p.y)}
            ctx.closePath();ctx.fillStyle="#ea80b0";ctx.fill();
            var img=new Image();img.src=c.toDataURL();return img})();

        function render(){
            requestAnimationFrame(render);
            var newTime=new Date().getTime()/1000,dt=newTime-(time||newTime);time=newTime;
            context.clearRect(0,0,canvas.width,canvas.height);
            var amount=particleRate*dt;
            for(var i=0;i<amount;i++){
                var pos=pointOnHeart(Math.PI-2*Math.PI*Math.random());
                var dir=pos.clone().length(settings.particles.velocity);
                particles.add(canvas.width/2+pos.x,canvas.height/2-pos.y,dir.x,-dir.y);}
            particles.update(dt);particles.draw(context,image)}
        function onResize(){canvas.width=canvas.clientWidth;canvas.height=canvas.clientHeight}
        window.onresize=onResize;onResize();render();
    })(document.getElementById("pinkboard"));
</script>


<!-- â¤ï¸â¤ï¸â¤ï¸ ç¬¬2éƒ¨åˆ†ï¼šç‚¹å‡»åæ¼«å¤©é£˜å¿ƒï¼ˆä¿æŒä¸è¦†ç›–pinkboardï¼‰ â¤ï¸â¤ï¸â¤ï¸ -->
<script>
    let started=false;
    const heartCanvas=document.getElementById("heartCanvas");
    const ctx2=heartCanvas.getContext("2d");

    function resizeH(){heartCanvas.width=innerWidth;heartCanvas.height=innerHeight}
    resizeH();window.onresize=resizeH;

    document.addEventListener("click",()=>{
        if(started) return;
        started=true;

        document.getElementById("name").innerText="â¤ï¸è£´æ€¡é™";
        bgm.play().catch(()=>{});

        startFloatingHearts();
    },{once:true});

    let hearts=[];
    function startFloatingHearts(){for(let i=0;i<120;i++)hearts.push(new Heart());animate()}
    class Heart{
        constructor(){this.reset()}
        reset(){this.x=Math.random()*innerWidth;this.y=innerHeight+Math.random()*300;
            this.size=Math.random()*40+10;this.speed=Math.random()*1.5+0.4;this.opacity=Math.random()*0.7+0.3}
        draw(){ctx2.globalAlpha=this.opacity;ctx2.font=this.size+"px sans-serif";ctx2.fillText("â¤ï¸",this.x,this.y)}
        update(){this.y-=this.speed;if(this.y<-50)this.reset()}
    }
    function animate(){
        ctx2.clearRect(0,0,innerWidth,innerHeight);
        hearts.forEach(h=>{h.update();h.draw()});
        requestAnimationFrame(animate);
    }
</script>

</body>
</html>
